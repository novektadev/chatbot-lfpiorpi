const _0x3d2211=_0x1f4c;function _0x1f4c(_0x433718,_0x4604cf){const _0x46af5d=_0x46af();return _0x1f4c=function(_0x1f4cce,_0x50dc5a){_0x1f4cce=_0x1f4cce-0x1df;let _0x134fe1=_0x46af5d[_0x1f4cce];return _0x134fe1;},_0x1f4c(_0x433718,_0x4604cf);}(function(_0x559771,_0xce9078){const _0x48e20f=_0x1f4c,_0x4e09e6=_0x559771();while(!![]){try{const _0x443232=parseInt(_0x48e20f(0x1ee))/0x1+-parseInt(_0x48e20f(0x23c))/0x2*(parseInt(_0x48e20f(0x21c))/0x3)+-parseInt(_0x48e20f(0x1fc))/0x4*(parseInt(_0x48e20f(0x225))/0x5)+parseInt(_0x48e20f(0x212))/0x6+-parseInt(_0x48e20f(0x20a))/0x7+-parseInt(_0x48e20f(0x201))/0x8*(parseInt(_0x48e20f(0x1fb))/0x9)+parseInt(_0x48e20f(0x20b))/0xa*(parseInt(_0x48e20f(0x235))/0xb);if(_0x443232===_0xce9078)break;else _0x4e09e6['push'](_0x4e09e6['shift']());}catch(_0x4df797){_0x4e09e6['push'](_0x4e09e6['shift']());}}}(_0x46af,0xc0ba1));import{bagOfWords,documentAsTree,stopWords,contextModel,loadBagOfWords,loadDocumentAsTree,loadStopWords,loadContextModel}from'./readModelData.js';async function displayDocumentTree(){const _0x3f3343=_0x1f4c;!documentAsTree&&(console[_0x3f3343(0x209)](_0x3f3343(0x21a)),await loadDocumentAsTree());if(documentAsTree)for(const [_0x3c7ae1,_0x3a0783]of Object[_0x3f3343(0x20c)](documentAsTree)){const _0x457729=_0x3c7ae1,_0x15cd5c=_0x3a0783;if(_0x15cd5c){const _0x174f1f=_0x15cd5c[_0x3f3343(0x1ff)],_0x2aa7c1=_0x15cd5c[_0x3f3343(0x234)];}}else console['warn'](_0x3f3343(0x239));}const calculateSimilarity=(_0x4e0d45,_0x455422)=>{const _0x5e7962=_0x1f4c,_0x28dd6c=_0x4e0d45['toLowerCase']()['split'](/\s+/),_0xbc3d4e=_0x28dd6c[_0x5e7962(0x21f)];if(_0xbc3d4e===0x0)return 0x0;const _0x3c1b6b=_0x28dd6c[_0x5e7962(0x1e1)]((_0x99cb61,_0x3839d2)=>_0x99cb61+(_0x455422[_0x3839d2]||0x0),0x0);return _0x3c1b6b/_0xbc3d4e;};async function evaluateContext(_0x2b5a2b){const _0x5bf03e=_0x1f4c;let _0x1536f6=[];const _0x4bd569=(_0x3b0f28,_0x1ba95b)=>{const _0x29e552=_0x1f4c,_0x851f88=_0x3b0f28[_0x29e552(0x21f)];if(_0x851f88===0x0)return 0x0;const _0x1b7d22=_0x3b0f28['reduce']((_0x1d4b84,_0x260672)=>_0x1d4b84+(_0x1ba95b[_0x260672]||0x0),0x0);return _0x1b7d22/_0x851f88;};!contextModel&&(console[_0x5bf03e(0x209)](_0x5bf03e(0x1fe)),await loadContextModel());if(contextModel)for(const _0x1398e0 of contextModel){if(_0x1398e0&&Array[_0x5bf03e(0x23b)](_0x1398e0[_0x5bf03e(0x200)]))for(const _0x564cba of _0x1398e0['textChunks']){const _0x274d0f=_0x564cba['chunkId'],_0x2c80e0=_0x564cba[_0x5bf03e(0x1ec)],_0x5bfff2=_0x4bd569(_0x2b5a2b,_0x2c80e0);if(_0x5bfff2>0x0){const _0xa0bfa={'pathName':_0x1398e0['pathName'],'chunkId':_0x274d0f,'score':_0x5bfff2};_0x1536f6['push'](_0xa0bfa);}}}else console[_0x5bf03e(0x1e5)](_0x5bf03e(0x239));return _0x1536f6;}async function getVectorToSearch(_0x1dd927){const _0x15b7e6=_0x1f4c,_0x27e9a3=/[\u0300-\u036f]/g,_0x4a3c88=/[!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,_0x399f8c=/\s+/g,_0x4a3bae=_0x1dd927[_0x15b7e6(0x1f5)]()['normalize'](_0x15b7e6(0x231))['replace'](_0x27e9a3,''),_0x4f1715=_0x4a3bae[_0x15b7e6(0x1f5)]()[_0x15b7e6(0x23e)](_0x4a3c88,'\x20'),_0x304e0c=_0x4f1715[_0x15b7e6(0x23e)](_0x399f8c,'\x20')[_0x15b7e6(0x20d)](),_0x43d7b6=_0x304e0c[_0x15b7e6(0x227)]('\x20')[_0x15b7e6(0x206)](Boolean);!stopWords&&await loadStopWords();if(stopWords){let _0x3100ed=[];const _0x40c480=new Set(stopWords);_0x3100ed[_0x15b7e6(0x21d)](..._0x43d7b6[_0x15b7e6(0x206)](_0x2620ba=>!_0x40c480[_0x15b7e6(0x213)](_0x2620ba)));if(_0x3100ed[_0x15b7e6(0x21f)]>=0x1){!bagOfWords&&await loadBagOfWords();if(bagOfWords){let _0x7c5802=[];const _0x553d06=Object['keys'](bagOfWords),_0x276e57=new Set(_0x553d06);return _0x7c5802['push'](..._0x3100ed['filter'](_0xe3ea95=>_0x276e57[_0x15b7e6(0x213)](_0xe3ea95))),_0x7c5802[_0x15b7e6(0x21f)]>=0x1?_0x7c5802:null;}}}}async function getRelatedLeafs(_0x2e2b3e,_0x4cf8fa){const _0x295de6=_0x1f4c;let _0x17530e=null;const _0x30d954=await evaluateContext(_0x2e2b3e);if(_0x30d954){const _0x3da049={};for(const _0x1ddef2 of _0x30d954){const _0x2318d9=_0x1ddef2[_0x295de6(0x232)];!_0x3da049[_0x2318d9]&&(_0x3da049[_0x2318d9]={'chunksIds':new Set(),'totalScore':0x0,'entryCount':0x0,'maxScore':-Infinity});const _0x427d77=_0x3da049[_0x2318d9];!_0x427d77[_0x295de6(0x1eb)][_0x295de6(0x213)](_0x1ddef2['chunkId'])&&(_0x427d77['chunksIds']['add'](_0x1ddef2[_0x295de6(0x238)]),_0x427d77[_0x295de6(0x1ef)]+=_0x1ddef2[_0x295de6(0x1f3)],_0x427d77[_0x295de6(0x1fd)]++,_0x1ddef2['score']>_0x427d77[_0x295de6(0x1e0)]&&(_0x427d77[_0x295de6(0x1e0)]=_0x1ddef2[_0x295de6(0x1f3)]));}const _0x1239c0=Object['entries'](_0x3da049)[_0x295de6(0x22b)](([_0xccf2b9,_0x26fd08])=>{const _0xbc7431=_0x295de6,_0x510c66=_0x26fd08[_0xbc7431(0x1ef)]/_0x26fd08[_0xbc7431(0x1fd)],_0x5d21d8=_0x26fd08[_0xbc7431(0x1e0)],_0x3f6def=(0x2*_0x5d21d8+_0x510c66)/0x3;return{'pathName':_0xccf2b9,'numChunks':_0x26fd08[_0xbc7431(0x1eb)][_0xbc7431(0x218)],'avgScore':_0x510c66,'maxScore':_0x5d21d8,'weightedAvg':_0x3f6def};});if(_0x1239c0){if(_0x1239c0[_0x295de6(0x21f)]>=0x1)return _0x1239c0[_0x295de6(0x1f2)]((_0x7ee76d,_0x245307)=>{const _0x2f457f=_0x295de6;if(_0x245307[_0x2f457f(0x210)]!==_0x7ee76d[_0x2f457f(0x210)])return _0x245307['weightedAvg']-_0x7ee76d[_0x2f457f(0x210)];return _0x245307[_0x2f457f(0x1ed)]-_0x7ee76d[_0x2f457f(0x1ed)];}),_0x17530e=_0x1239c0['slice'](0x0,_0x4cf8fa),_0x17530e;}else return null;}else return null;}async function getResponsePaths(_0x45f134){const _0x2adb35=_0x1f4c,_0x3329a8=[];let _0x10fbb3=0x1;for(const _0x50369e of _0x45f134){let _0x9f1363=Array(0x8)[_0x2adb35(0x22f)]('');const _0x31bf50=_0x50369e[_0x2adb35(0x232)][_0x2adb35(0x227)]('/');if(_0x31bf50){for(let _0x3a8d69=0x1;_0x3a8d69<_0x31bf50[_0x2adb35(0x21f)];_0x3a8d69++){_0x3a8d69>0x1?_0x9f1363[_0x3a8d69-0x1]=_0x9f1363[_0x3a8d69-0x2]+'/'+_0x31bf50[_0x3a8d69]:_0x9f1363[_0x3a8d69-0x1]='/'+_0x31bf50[_0x3a8d69];}_0x3329a8[_0x2adb35(0x21d)](_0x9f1363);}_0x10fbb3+=0x1;}return _0x3329a8;}async function getHTMLResponse(_0x1cce88){const _0x13aa9c=_0x1f4c;if(_0x1cce88[_0x13aa9c(0x21f)]>=0x1){let _0x11dfe1='';for(let _0x391015=0x0;_0x391015<_0x1cce88[_0x13aa9c(0x21f)];_0x391015++){for(let _0xd39dc7=0x1;_0xd39dc7<_0x1cce88[_0x391015]['length'];_0xd39dc7++){const _0x336de7=_0x1cce88[_0x391015][_0xd39dc7];if(_0x336de7!==''){let _0x59c310='',_0x3cf982='';const _0x218432=_0x336de7[_0x13aa9c(0x227)]('/'),_0x3e0e97=_0x218432['at'](-0x1);!documentAsTree&&await loadDocumentAsTree();documentAsTree&&(_0x336de7 in documentAsTree&&(_0x3cf982=documentAsTree[_0x336de7]['text']));if(_0x3e0e97!==_0x13aa9c(0x207)&&_0x3e0e97!=='U')switch(_0xd39dc7){case 0x1:_0x59c310=_0x13aa9c(0x214)+_0x3e0e97+_0x13aa9c(0x1f8)+_0x3cf982+_0x13aa9c(0x223);break;case 0x2:_0x59c310=_0x13aa9c(0x1f7)+_0x3e0e97+'</b>\x20-\x20'+_0x3cf982+_0x13aa9c(0x21e);break;case 0x3:_0x59c310=_0x13aa9c(0x226)+_0x3e0e97+_0x13aa9c(0x217)+_0x3cf982+'</p>\x0a';break;case 0x4:_0x59c310='<p\x20style=\x22padding-left:20px;\x22><b>'+_0x3e0e97+_0x13aa9c(0x1f8)+_0x3cf982+'</p>\x0a';break;case 0x5:_0x59c310='<p\x20style=\x22padding-left:40px;\x22><b>'+_0x3e0e97+_0x13aa9c(0x204)+_0x3cf982+_0x13aa9c(0x208);break;case 0x6:_0x59c310=_0x13aa9c(0x237)+_0x3e0e97+'</b>\x20\x0a'+_0x3cf982+_0x13aa9c(0x208);break;default:_0x59c310=_0x3cf982+_0x13aa9c(0x1f4);break;}else _0x3e0e97===_0x13aa9c(0x207)&&(_0x59c310=_0x13aa9c(0x22d)+_0x3cf982+_0x13aa9c(0x1e9)),_0x3e0e97=='U'&&(_0x59c310='\x0a');_0x11dfe1+=_0x59c310;}}_0x11dfe1+='<br>';}return _0x11dfe1;}return null;}async function addMessageToChat(_0x443d2d,_0x2923b2){const _0x2faa34=_0x1f4c;let _0x564eed='';const _0x13dc34=document[_0x2faa34(0x211)](_0x2faa34(0x1f0));_0x2923b2==='user'&&(_0x564eed='<p><strong>usuario:</strong>\x20'+_0x443d2d+_0x2faa34(0x23a),_0x13dc34['className']=_0x2faa34(0x203),_0x13dc34[_0x2faa34(0x22c)]='background-color:\x20#dddddd;\x20padding:\x200.75rem;\x20border-radius:\x200.5rem;\x20margin-bottom:\x200.5rem;'),_0x2923b2===_0x2faa34(0x222)&&(_0x564eed=_0x2faa34(0x233)+_0x443d2d,_0x13dc34[_0x2faa34(0x1e8)]=_0x2faa34(0x1df),_0x13dc34[_0x2faa34(0x22c)]='background-color:\x20#e6f7ff;\x20padding:\x200.75rem;\x20border-radius:\x200.5rem;\x20margin-bottom:\x200.5rem;'),_0x2923b2==='warning'&&(_0x564eed=_0x2faa34(0x230)+_0x443d2d+_0x2faa34(0x219),_0x13dc34[_0x2faa34(0x1e8)]=_0x2faa34(0x1df),_0x13dc34[_0x2faa34(0x22c)]=_0x2faa34(0x20e)),_0x2923b2===_0x2faa34(0x1e7)&&(_0x564eed='<p><strong>Agente:</strong>'+_0x443d2d+_0x2faa34(0x219),_0x13dc34[_0x2faa34(0x1e8)]=_0x2faa34(0x1df),_0x13dc34[_0x2faa34(0x22c)]=_0x2faa34(0x22e)),_0x13dc34[_0x2faa34(0x202)]=_0x564eed,chatContainer[_0x2faa34(0x236)](_0x13dc34),_0x13dc34[_0x2faa34(0x1f6)]({'behavior':'smooth','block':_0x2faa34(0x205)});}async function sendMessage(){const _0x200dbe=_0x1f4c,_0x2a5ce6=userInput[_0x200dbe(0x215)][_0x200dbe(0x20d)]();if(_0x2a5ce6!==''){const _0x3a48b8=await getVectorToSearch(_0x2a5ce6);if(_0x3a48b8!==null){if(_0x3a48b8[_0x200dbe(0x21f)]>=0x3){addMessageToChat(_0x2a5ce6,_0x200dbe(0x22a));const _0x4ea89f=document[_0x200dbe(0x221)](_0x200dbe(0x1e2)),_0x11e934=await getRelatedLeafs(_0x3a48b8,_0x4ea89f[_0x200dbe(0x215)]),_0x404473=await getResponsePaths(_0x11e934),_0x4c8d66=await getHTMLResponse(_0x404473);addMessageToChat(_0x4c8d66,_0x200dbe(0x222));}else addMessageToChat('Para\x20darte\x20mejores\x20resultados,\x20necesito\x20más\x20detalles\x20en\x20tu\x20pregunta.\x20Por\x20favor,\x20añade\x20un\x20poco\x20más\x20de\x20contexto',_0x200dbe(0x224));}else addMessageToChat(_0x200dbe(0x1e3)+_0x2a5ce6+'\x22</strong>,\x20no\x20esta\x20relacionada\x20con\x20los\x20alcances\x20de\x20este\x20chatbot','error');}}const currentTimeSpan=document[_0x3d2211(0x221)](_0x3d2211(0x1ea));function updateLocalTime(){const _0x429848=_0x3d2211,_0x119fbc={'timeZone':_0x429848(0x1e6),'hour':'numeric','minute':_0x429848(0x229),'second':_0x429848(0x229),'hour12':!![]},_0x4f0fb0=new Date()['toLocaleTimeString']('en-US',_0x119fbc);currentTimeSpan['textContent']=_0x4f0fb0;}updateLocalTime(),setInterval(updateLocalTime,0x3e8);const chatContainer=document[_0x3d2211(0x221)]('chatContainer'),userInput=document[_0x3d2211(0x221)](_0x3d2211(0x20f)),sendButton=document[_0x3d2211(0x221)](_0x3d2211(0x1f1)),typingIndicator=document[_0x3d2211(0x221)]('typingIndicator'),maxChunksInput=document['getElementById'](_0x3d2211(0x1e2)),queryExamples=document[_0x3d2211(0x220)](_0x3d2211(0x1f9));queryExamples[_0x3d2211(0x21f)]>=0x1&&queryExamples[_0x3d2211(0x1fa)](_0x12e228=>{const _0x326104=_0x3d2211;_0x12e228[_0x326104(0x23d)](_0x326104(0x228),_0x1f8878=>{const _0x1a5418=_0x326104;userInput[_0x1a5418(0x215)]=_0x12e228['dataset']['query'],sendMessage();});});;sendButton[_0x3d2211(0x23d)]('click',sendMessage),userInput[_0x3d2211(0x23d)](_0x3d2211(0x21b),_0x605bf4=>{const _0x61be14=_0x3d2211;if(_0x605bf4[_0x61be14(0x216)]===_0x61be14(0x1e4))sendMessage();});function _0x46af(){const _0x137c7e=['warn','America/Mazatlan','error','className','}</i></p>\x0a','currentTime','chunksIds','chunk','numChunks','46297hvmDPF','totalScore','div','sendButton','sort','score','}<br>\x0a','toLowerCase','scrollIntoView','<h4><b>Seccion\x20','</b>\x20-\x20','.example-btn','forEach','27OawnXD','40OEhitg','entryCount','Context\x20model\x20not\x20yet\x20loaded,\x20loading\x20now...','type','textChunks','2257936dRsqhp','innerHTML','message-bubble\x20user-message','</b>\x20','end','filter','accion',')</p>\x0a','log','9607542GdIpCX','10TXpgdO','entries','trim','background-color:\x20#f8ed62;\x20padding:\x200.75rem;\x20border-radius:\x200.5rem;\x20margin-bottom:\x200.5rem;','userInput','weightedAvg','createElement','4922772QCswBn','has','<h3><b>Capitulo\x20','value','key','</b>:\x20','size',':</p>','document\x20tree\x20not\x20yet\x20loaded,\x20loading\x20now...','keypress','1989rGYJra','push','</h4>\x0a','length','querySelectorAll','getElementById','bot','\x20</h3>\x0a','warning','206785vUckuf','<p><b>Articulo\x20','split','click','numeric','user','map','style','<p><i>','background-color:\x20#f69697;\x20padding:\x200.75rem;\x20border-radius:\x200.5rem;\x20margin-bottom:\x200.5rem;','fill','<p><strong>Agente:</strong>','NFD','pathName','<p><strong>Agente:</strong>\x20\x20Con\x20fundamento\x20en:</p>\x0a','text','39683963oezbzX','appendChild','<p\x20style=\x22padding-left:60px;\x22><b>','chunkId','documentAsTree\x20is\x20not\x20available.','</p>','isArray','3174GJleWw','addEventListener','replace','message-bubble\x20bot-message','maxScore','reduce','maxChunks','Su\x20consula\x20\x22<strong>','Enter'];_0x46af=function(){return _0x137c7e;};return _0x46af();}